<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="product_table">
	<insert id="p_insert" parameterType="pvo">
	    INSERT INTO product_table (user_idx, p_name, p_type, p_brand, p_volume, p_price, buy_rate, total_quatity, p_main_img, regdate) 
	    VALUES (#{user_idx}, #{p_name},#{p_type},#{p_brand},#{p_volume},#{p_price},0,#{total_quatity}, #{p_main_img}, sysdate())
	</insert>
	<insert id="p_img_insert" parameterType="pivo">
		<selectKey keyProperty="p_idx" resultType="String" order="BEFORE">
			SELECT (IFNULL(MAX(p_idx),0)) as p_idx FROM product_table
	    </selectKey>
	    INSERT INTO product_img_table (p_idx, user_idx, p_img, p_img_type) 
	    VALUES (#{p_idx}, #{user_idx},#{p_img},#{p_img_type})
	</insert>
	
</mapper>















